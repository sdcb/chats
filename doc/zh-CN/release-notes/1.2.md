<!-- Language: zh-CN -->
<p align="right"><a href="../../en-US/release-notes/1.2.md">English</a> | <b>简体中文</b></p>

# Chats 1.2.0 发布说明

> 发布日期：2025-04-25（相对 1.1.0 以来 15 次提交）

1.2.0 版本是一次重要的管理体验升级，核心聚焦于管理员仪表盘和数据可视化功能的完善，同时优化了聊天消息的交互体验。本版本新增了管理员数据分析面板，支持多种数据图表展示和移动端自适应，并对聊天消息页面进行了全面的 UI/UX 优化。

## 亮点概览

- **管理员仪表盘（Dashboard）**：新增数据可视化面板，支持聊天量、消费成本、Token 使用等多维度统计分析
- **移动端适配**：管理面板全面支持移动设备访问，优化侧边栏和响应式布局
- **聊天消息 UI 优化**：改进消息展示样式，新增消息显示类型切换功能
- **交互体验改进**：消息编辑改为 Ctrl+Enter 更新，搜索增加防抖优化

---

## 新功能与改进详情

### 1) 管理员仪表盘（Dashboard）

全新的数据分析与可视化功能：

**核心组件**：
- `ChatCountChart`：聊天数量趋势图
- `CostConsumptionChart`：成本消耗分析图
- `TokenConsumptionChart`：Token 使用统计图
- `PieChartCard`：饼图卡片组件，支持多种数据维度
- `StatsCards`：统计卡片，快速查看关键指标
- `DateSelector`：日期选择器，支持自定义时间范围

**技术实现**：
- 集成 Recharts 图表库，提供丰富的图表类型
- 新增 `adminApis.ts` 管理 API 接口
- 支持暗色/亮色主题自动适配
- 图表组件可复用，易于扩展

**数据维度**：
- 用户活跃度统计
- 模型使用分布
- 成本趋势分析
- Token 消耗监控
- 聊天会话统计

### 2) 移动端自适应

管理面板全面移动端适配：

**UI 组件升级**：
- 新增 `sidebar.tsx` 组件（783 行），实现响应式侧边栏
- 添加 `useMobile` Hook，智能检测移动设备
- 优化管理面板布局（`admin/layout/index.tsx`）

**适配范围**：
- 仪表盘（Dashboard）
- 用户管理（Users）
- 模型管理（Models）
- 消息管理（Messages）
- 全局配置（Global Configs）
- 文件服务（File Service）
- 登录服务（Login Service）
- 邀请码管理（Invitation Code）
- 用户配置（User Config）
- 用量统计（Usage）

**交互优化**：
- 移动端触摸友好的按钮尺寸
- 自适应表格和卡片布局
- 优化的导航菜单体验

### 3) 聊天消息体验优化

多项消息交互改进：

**消息显示模式切换**：
- 新增消息展示类型切换功能（`toggle message display type`）
- 用户可选择不同的消息渲染样式
- `ChatMessage` 和 `ResponseMessage` 组件重构
- 增加 `chatMessage.ts` 类型定义

**消息样式优化**：
- 进行 5 次迭代优化消息 UI/UX（`adjust message uiux`）
- 改进消息的视觉层次和间距
- 优化消息气泡样式和颜色对比度
- 增强可读性和视觉一致性

**编辑交互改进**：
- 消息编辑改为 Ctrl+Enter 触发更新
- 避免误操作导致的意外提交
- 更符合用户的操作习惯

### 4) 性能与体验优化

**搜索防抖**：
- 为搜索功能添加防抖（debounce）处理
- 减少不必要的 API 调用
- 提升搜索响应速度和服务器性能

**UI 细节优化**：
- 优化图标和按钮样式
- 改进导出按钮（`ExportButton`）交互
- 调整全局 CSS 样式（`globals.css`）
- 优化聊天预设列表（`ChatPresetList`）和模态框（`ChatPresetModal`）

**代码质量**：
- 修复公司导入错误（`fix company import error`）
- 移除无用引用（`remove useless references`）
- 代码结构优化和清理

### 5) 依赖与工具升级

**前端依赖**：
- 新增 Recharts 图表库及相关依赖
- 更新 Radix UI 组件库版本
- 新增图表相关类型定义（`chart.ts`）
- 扩展通用类型定义（`common.ts`）

**国际化**：
- 更新中文和英文语言包
- 新增仪表盘和图表相关翻译
- 完善用户界面文案

---

## 技术细节

### 图表库集成

本版本集成了 Recharts 作为主要的数据可视化方案：
- 声明式 React 组件 API
- 支持多种图表类型（折线图、柱状图、饼图等）
- 内置响应式支持
- 易于自定义主题和样式

### 移动端响应式设计

采用现代响应式设计实践：
- Tailwind CSS 媒体查询
- Flexible Box 和 Grid 布局
- 触摸优化的交互元素
- 自适应的导航和侧边栏

### 组件架构优化

改进的组件设计模式：
- 更细粒度的组件拆分
- 增强的组件复用性
- 更清晰的数据流和状态管理
- TypeScript 类型安全保障

---

## 升级注意事项

### 兼容性

- 本版本与 1.1.0 完全向后兼容
- 无需数据库迁移
- 前端资源需要重新部署

### 部署建议

1. 备份当前部署（可选但推荐）
2. 停止现有服务
3. 部署新版本文件
4. 清除浏览器缓存以加载新前端资源
5. 启动服务并验证功能

### Docker 镜像

支持多平台 Docker 镜像：
- Linux x64: `sdcb/chats:1.2.0.780-linux-x64`
- Linux ARM64: `sdcb/chats:1.2.0.780-linux-arm64`
- Windows Nano Server 1809: `sdcb/chats:1.2.0.780-nanoserver-1809`
- Windows Nano Server LTSC 2022: `sdcb/chats:1.2.0.780-nanoserver-ltsc2022`
- Windows Nano Server LTSC 2025: `sdcb/chats:1.2.0.780-nanoserver-ltsc2025`

---

## 相关链接

- **完整变更日志**：https://github.com/sdcb/chats/compare/1.1.0.774...1.2.0.780
- **GitHub Release**：https://github.com/sdcb/chats/releases/tag/1.2.0.780
- **Docker Hub**：https://hub.docker.com/r/sdcb/chats

---

## 致谢

感谢所有为此版本做出贡献的开发者和用户反馈！

特别感谢 @gray 对管理面板和可视化功能的重要贡献。
